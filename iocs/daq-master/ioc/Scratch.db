# records for scripts/MonitorScratch.pl

# we use calc records instead of ai to do some unit conversion,
# first calc is more flexible and second ai has RVAL as long,
# so floats are a bit difficult to feed in....

record(calc, "GEN:MON:Runfilesize_fast")
{
    field(DESC, "Filesize of newest file in scratch")
    field(EGU, "MB")
    field (CALC, "A")
    field(LOPR, 0)
    field(HOPR, 8000)
    field(HIGH, 6800)
    field(LOW, 0)
    field(LOLO, 0)
    field(HIHI, 7000)

}

record(calc, "GEN:MON:Runfilesize")
{
    field(INPA, "GEN:MON:Runfilesize_fast")
    field(CALC, "A")
    field(SCAN, "1 second")
    field(EGU, "MB")
}

record(stringin, "GEN:MON:Runfilename")
{
    field(DESC, "Filename of newest file in scratch")    
}

record(calc, "GEN:MON:EventsWithError")
{
    field(CALC, "A")
}

record(calc, "GEN:MON:Pi0PerScRead")
{
    field(CALC, "A")
}

record(calc, "GEN:MON:Pi0Asymmetry")
{
    field(CALC, "A")
}

#record(calc, "GEN:MON:MaxTaggRate")
#{
#    field(DESC, "Current highest rate in tagger")
#    field(EGU, "Hz")
#    field(CALC, "A")
#    field(HIGH, 100000)
#    field(HIGH, 120000)
#}

record(calc, "GEN:MON:MaxTaggRate1")
{
    field(DESC, "Current highest rate in tagger")
    field(EGU, "Hz")
    field(SCAN, "1 second")
    field(CALC, "MAX(A,B,C,D,E,F,G,H,I,J,K)")
    field(INPA, "TAGG:TAGG:SectorA:TRIG:OR")
    field(INPB, "TAGG:TAGG:SectorB:TRIG:OR")
    field(INPC, "TAGG:TAGG:SectorC:TRIG:OR")
    field(INPD, "TAGG:TAGG:SectorD:TRIG:OR")
    field(INPE, "TAGG:TAGG:SectorE:TRIG:OR")
    field(INPF, "TAGG:TAGG:SectorF:TRIG:OR")
    field(INPG, "TAGG:TAGG:SectorG:TRIG:OR")
    field(INPH, "TAGG:TAGG:SectorH:TRIG:OR")
    field(INPI, "TAGG:TAGG:SectorI:TRIG:OR")
    field(INPJ, "TAGG:TAGG:SectorJ:TRIG:OR")
    field(INPK, "TAGG:TAGG:SectorK:TRIG:OR")
}

record(calc, "GEN:MON:MaxTaggRate2")
{
    field(DESC, "Current highest rate in tagger")
    field(EGU, "Hz")
    field(SCAN, "1 second")
    field(CALC, "MAX(A,B,C,D,E,F,G,H,I,J,K)")
    field(INPA, "TAGG:TAGG:SectorL:TRIG:OR")
    field(INPB, "TAGG:TAGG:SectorM:TRIG:OR")
    field(INPC, "TAGG:TAGG:SectorN:TRIG:OR")
    field(INPD, "TAGG:TAGG:SectorO:TRIG:OR")
    field(INPE, "TAGG:TAGG:SectorP:TRIG:OR")
    field(INPF, "TAGG:TAGG:SectorQ:TRIG:OR")
    field(INPG, "TAGG:TAGG:SectorR:TRIG:OR")
    field(INPH, "TAGG:TAGG:SectorS:TRIG:OR")
    field(INPI, "TAGG:TAGG:SectorT:TRIG:OR")
    field(INPJ, "TAGG:TAGG:SectorU:TRIG:OR")
    field(INPK, "TAGG:TAGG:SectorV:TRIG:OR")
}

record(calc, "GEN:MON:MaxTaggRate")
{
    field(DESC, "Current highest rate in tagger")
    field(EGU, "Hz")
    field(SCAN, "1 second")
    field(CALC, "MAX(A,B)")
    field(INPA, "GEN:MON:MaxTaggRate1")
    field(INPB, "GEN:MON:MaxTaggRate2")
    field(HIGH, 100000)
    field(HIHI, 120000)
}

#record(calc, "GEN:MON:MaxTaggRate1")
#{
#    field(DESC, "Current highest rate in tagger")
#    field(EGU, "Hz")
#    field(CALC, "((L>0) ? ((L>K) ? (L/16) : (L/8)) : ((K>0) ? ((K>J) ? (K/16) : (K/8)) : ((J>0) ? ((J>I) ? (J/16) : (J/8)) : ((I>0) ? ((I>H) ? (I/16) : (I/8)) : ((H>0) ? ((H>G) ? (H/16) : (H/8)) : ((G>0) ? ((G>F) ? (G/16) : (G/8)) : ((F>0) ? ((F>E) ? (F/16) : (F/8)) : ((E>0) ? ((E>D) ? (E/16) : (E/8)) : ((D>0) ? ((D>C) ? (D/16) : (D/8)) : ((C>0) ? ((C>B) ? (C/16) : (C/8)) : ((B>0) ? ((B>A) ? (B/16) : (B/8)) : A)))))))))))")
#    field(INPA, "TAGG:TAGG:SectorA:TRIG:OR")
#    field(INPB, "TAGG:TAGG:SectorB:TRIG:OR")
#    field(INPC, "TAGG:TAGG:SectorC:TRIG:OR")
#    field(INPD, "TAGG:TAGG:SectorD:TRIG:OR")
#    field(INPE, "TAGG:TAGG:SectorE:TRIG:OR")
#    field(INPF, "TAGG:TAGG:SectorF:TRIG:OR")
#    field(INPG, "TAGG:TAGG:SectorG:TRIG:OR")
#    field(INPH, "TAGG:TAGG:SectorH:TRIG:OR")
#    field(INPI, "TAGG:TAGG:SectorI:TRIG:OR")
#    field(INPJ, "TAGG:TAGG:SectorJ:TRIG:OR")
#    field(INPK, "TAGG:TAGG:SectorK:TRIG:OR")
#    field(INPL, "TAGG:TAGG:SectorL:TRIG:OR")
#}
#
#record(calc, "GEN:MON:MaxTaggRate2")
#{
#    field(DESC, "Current highest rate in tagger")
#    field(EGU, "Hz")
#    field(CALC, "((K>0) ? ((K>J) ? (K/16) : (K/8)) : ((J>0) ? ((J>I) ? (J/16) : (J/8)) : ((I>0) ? ((I>H) ? (I/16) : (I/8)) : ((H>0) ? ((H>G) ? (H/16) : (H/8)) : ((G>0) ? ((G>F) ? (G/16) : (G/8)) : ((F>0) ? ((F>E) ? (F/16) : (F/8)) : ((E>0) ? ((E>D) ? (E/16) : (E/8)) : ((D>0) ? ((D>C) ? (D/16) : (D/8)) : ((C>0) ? ((C>B) ? (C/16) : (C/8)) : ((B>0) ? ((B>A) ? (B/16) : (B/8)) : A))))))))))")
#    field(INPA, "TAGG:TAGG:SectorL:TRIG:OR")
#    field(INPB, "TAGG:TAGG:SectorM:TRIG:OR")
#    field(INPC, "TAGG:TAGG:SectorN:TRIG:OR")
#    field(INPD, "TAGG:TAGG:SectorO:TRIG:OR")
#    field(INPE, "TAGG:TAGG:SectorP:TRIG:OR")
#    field(INPF, "TAGG:TAGG:SectorQ:TRIG:OR")
#    field(INPG, "TAGG:TAGG:SectorR:TRIG:OR")
#    field(INPH, "TAGG:TAGG:SectorS:TRIG:OR")
#    field(INPI, "TAGG:TAGG:SectorT:TRIG:OR")
#    field(INPJ, "TAGG:TAGG:SectorU:TRIG:OR")
#    field(INPK, "TAGG:TAGG:SectorV:TRIG:OR")
#}
#
#record(calc, "GEN:MON:MaxTaggRate")
#{
#    field(DESC, "Current highest rate in tagger")
#    field(EGU, "Hz")
#    field(CALC, "MAX(A,B)")
#    field(INPA, "GEN:MON:MaxTaggRate1")
#    field(INPB, "GEN:MON:MaxTaggRate2")
#    field(HIGH, 100000)
#    field(HIHI, 120000)
#}
